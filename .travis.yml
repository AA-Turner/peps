language: python
python:
  - 3.7
  - 3.7-dev
  - 3.8
  - 3.8-dev
dist: xenial

cache: pip

install:
    - pip install -r requirements.txt

jobs:
  fast_finish: true

  include:
    # Main run, tests build, RSS, and packaging
    - name: "3.7 Makefile Build"
      python: 3.7
      env: COMMAND="make -j$(nproc)"

  allow_failures:
    # Note test failure, but pass the build
    - env: FAIL_ALLOWED=true

deploy:
    provider: script
    script: bash deploy.bash
    skip_cleanup: true
    on:
        branch: master
